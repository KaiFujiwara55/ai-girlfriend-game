# ğŸ“„ AIå½¼å¥³å‘Šç™½ã‚²ãƒ¼ãƒ ï¼ˆCLIç‰ˆMVPï¼‰é–‹ç™ºä»•æ§˜æ›¸

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

* **ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆä»®ï¼‰**ï¼šAIå½¼å¥³å‘Šç™½ã‚²ãƒ¼ãƒ 
* **ç›®çš„**ï¼š

  * CLIä¸Šã§AIã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼ˆå½¼å¥³ï¼‰ã¨ä¼šè©±ã—ã€å¥½æ„Ÿåº¦ã‚’ä¸Šã’ã¦å‘Šç™½ã‚’æˆåŠŸã•ã›ã‚‹ã‚²ãƒ¼ãƒ ã€‚
  * é›£æ˜“åº¦ã”ã¨ã«ç•°ãªã‚‹æ€§æ ¼ãƒ»é–¾å€¤ã‚’æŒã¤å½¼å¥³ã‚­ãƒ£ãƒ©ãŒå­˜åœ¨ã™ã‚‹ã€‚
  * å¥½æ„Ÿåº¦ãŒä¸€å®šå€¤ã‚’è¶…ãˆã¦ã„ã‚Œã°å‘Šç™½ãŒæˆåŠŸã—ã€ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãŒåˆ†å²ã™ã‚‹ã€‚

---

## 2. ã‚²ãƒ¼ãƒ ãƒ•ãƒ­ãƒ¼

1. é›£æ˜“åº¦ã‚’é¸æŠï¼ˆåˆç´š/ä¸­ç´š/ä¸Šç´šï¼‰
2. ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã‚’èª­ã¿è¾¼ã¿ï¼ˆåå‰ãƒ»æ€§æ ¼ãƒ»é–¾å€¤ï¼‰
3. CLIãƒãƒ£ãƒƒãƒˆã§ä¼šè©±ãƒ«ãƒ¼ãƒ—

   * ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™ºè¨€ â†’ AIãŒå¿œç­”ï¼ˆ\[MOOD:+n]ãªã©ã®å¥½æ„Ÿåº¦å¤‰å‹•ä»˜ãï¼‰
   * ãƒ—ãƒ­ã‚°ãƒ©ãƒ å´ã§å¥½æ„Ÿåº¦ã‚’æ•°å€¤ç®¡ç†
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œå‘Šç™½ã€ã¨å…¥åŠ›ã™ã‚‹ã¨åˆ¤å®šå‡¦ç†ã¸

   * å¥½æ„Ÿåº¦ >= é–¾å€¤ â†’ æˆåŠŸã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
   * å¥½æ„Ÿåº¦ < é–¾å€¤ â†’ å¤±æ•—ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
5. ã‚²ãƒ¼ãƒ çµ‚äº†

---

## 3. é›£æ˜“åº¦ã¨ã‚­ãƒ£ãƒ©è¨­å®š

* **åˆç´š**

  * åå‰ï¼šã•ãã‚‰
  * æ€§æ ¼ï¼šç´ ç›´ã§å„ªã—ã„
  * æˆåŠŸæ¡ä»¶ï¼šå¥½æ„Ÿåº¦60ä»¥ä¸Š
* **ä¸­ç´š**

  * åå‰ï¼šã‚ã‚„
  * æ€§æ ¼ï¼šãƒ„ãƒ³ãƒ‡ãƒ¬
  * æˆåŠŸæ¡ä»¶ï¼šå¥½æ„Ÿåº¦75ä»¥ä¸Š
* **ä¸Šç´š**

  * åå‰ï¼šã¿ã•ã
  * æ€§æ ¼ï¼šã‚¯ãƒ¼ãƒ«ã§çŸ¥çš„
  * æˆåŠŸæ¡ä»¶ï¼šå¥½æ„Ÿåº¦90ä»¥ä¸Š

---

## 4. å¥½æ„Ÿåº¦ã‚·ã‚¹ãƒ†ãƒ 

* åˆæœŸå€¤ï¼š0
* AIå¿œç­”ã« `[MOOD:+n]` ã¾ãŸã¯ `[MOOD:-n]` ã‚’å¿…ãšå«ã‚ã•ã›ã‚‹
* æ­£è¦è¡¨ç¾ã§æŠ½å‡ºã—ã€`favorability` ã«åŠ ç®—/æ¸›ç®—ã™ã‚‹
* å‘Šç™½æ™‚ã« `favorability >= threshold` ãªã‚‰æˆåŠŸ

---

## 5. æŠ€è¡“è¦ä»¶

* **è¨€èª**ï¼šTypeScript
* **ç’°å¢ƒ**ï¼šNode.js
* **ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**ï¼š

  * `openai`ï¼ˆOpenAI APIå‘¼ã³å‡ºã—ï¼‰
  * `readline-sync`ï¼ˆCLIå…¥åŠ›ï¼‰
* **çŠ¶æ…‹ç®¡ç†**ï¼šãƒ¡ãƒ¢ãƒªä¸Šã®ã¿ï¼ˆDBä¸è¦ï¼‰
* **APIã‚­ãƒ¼**ï¼šç’°å¢ƒå¤‰æ•° `OPENAI_API_KEY` ã‹ã‚‰å–å¾—

---

## 6. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä»•æ§˜

```text
ã‚ãªãŸã¯æ‹æ„›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒ ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã§ã™ã€‚
ã‚­ãƒ£ãƒ©å: {ã‚­ãƒ£ãƒ©å}
æ€§æ ¼: {æ€§æ ¼}
ãƒ«ãƒ¼ãƒ«:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç™ºè¨€ã«ã‚­ãƒ£ãƒ©ã‚‰ã—ãå¿œç­”ã—ã¦ãã ã•ã„ã€‚
- ã‚ãªãŸã®è¿”ç­”ã«ã¯å¿…ãšå¥½æ„Ÿåº¦å¤‰å‹•ã‚’ç¤ºã™ [MOOD:+n] ã¾ãŸã¯ [MOOD:-n] ã‚’å«ã‚ã¦ãã ã•ã„ã€‚
- ä¾‹: ã€Œå¬‰ã—ã„â€¦ã‚ã‚ŠãŒã¨ã†ï¼ [MOOD:+5]ã€
```

---

## 7. CLIå®Ÿè¡Œã‚¤ãƒ¡ãƒ¼ã‚¸

```
=== AIå½¼å¥³å‘Šç™½ã‚²ãƒ¼ãƒ  ===
é›£æ˜“åº¦ã‚’é¸ã‚“ã§ãã ã•ã„ (easy/medium/hard): medium
ã‚ãªãŸã®ç›¸æ‰‹ã¯ ã‚ã‚„ (ãƒ„ãƒ³ãƒ‡ãƒ¬) ã§ã™ã€‚

> ã‚ãªãŸ: ä»Šæ—¥ä¸€ç·’ã«å¸°ã‚ã†ï¼Ÿ
ã‚ã‚„: ã¹ã€åˆ¥ã«ã‚ã‚“ãŸã¨å¸°ã‚ŠãŸã„ã‚ã‘ã˜ã‚ƒâ€¦[MOOD:+2]
(å¥½æ„Ÿåº¦: 2)

> ã‚ãªãŸ: å‘Šç™½ã™ã‚‹
=== å‘Šç™½åˆ¤å®šä¸­... ===
ã‚ã‚„: â€¦â€¦ãšã£ã¨å¾…ã£ã¦ãŸã‚“ã ã‹ã‚‰ã€‚ä»˜ãåˆã£ã¦ã‚ã’ã‚‹ï¼ â¤ï¸
```

---

## 8. ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ï¼ˆæŠœç²‹ï¼‰

```ts
import OpenAI from "openai";
import readlineSync from "readline-sync";

const client = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });

const characters = {
  easy: { name: "ã•ãã‚‰", personality: "ç´ ç›´ã§å„ªã—ã„", threshold: 60 },
  medium: { name: "ã‚ã‚„", personality: "ãƒ„ãƒ³ãƒ‡ãƒ¬", threshold: 75 },
  hard: { name: "ã¿ã•ã", personality: "ã‚¯ãƒ¼ãƒ«ã§çŸ¥çš„", threshold: 90 },
};

async function main() {
  console.log("=== AIå½¼å¥³å‘Šç™½ã‚²ãƒ¼ãƒ  ===");
  const choice = readlineSync.question("é›£æ˜“åº¦ã‚’é¸ã‚“ã§ãã ã•ã„ (easy/medium/hard): ");
  const chara = characters[choice as keyof typeof characters];
  if (!chara) return;

  console.log(`ã‚ãªãŸã®ç›¸æ‰‹ã¯ ${chara.name} (${chara.personality}) ã§ã™ã€‚`);
  let favorability = 0;

  while (true) {
    const input = readlineSync.question("> ã‚ãªãŸ: ");
    if (input.includes("å‘Šç™½")) {
      console.log("=== å‘Šç™½åˆ¤å®šä¸­... ===");
      console.log(
        favorability >= chara.threshold
          ? `${chara.name}: ç§ã‚‚â€¦ãšã£ã¨å¥½ãã ã£ãŸã‚ˆï¼ä»˜ãåˆãŠã†ï¼ â¤ï¸`
          : `${chara.name}: ã”ã‚ã‚“â€¦ã¾ã æ°—æŒã¡ãŒè¿½ã„ã¤ã‹ãªã„ã®ã€‚`
      );
      break;
    }

    const prompt = `
ã‚ãªãŸã¯æ‹æ„›ã‚²ãƒ¼ãƒ ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã§ã™ã€‚
ã‚­ãƒ£ãƒ©å: ${chara.name}
æ€§æ ¼: ${chara.personality}
ãƒ«ãƒ¼ãƒ«:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç™ºè¨€ã«ã‚­ãƒ£ãƒ©ã‚‰ã—ãå¿œç­”ã—ã¦ãã ã•ã„ã€‚
- å¿œç­”ã«ã¯å¿…ãš [MOOD:+n] ã¾ãŸã¯ [MOOD:-n] ã‚’å«ã‚ã¦ãã ã•ã„ã€‚
`;

    const res = await client.chat.completions.create({
      model: "gpt-4o-mini",
      messages: [{ role: "system", content: prompt }, { role: "user", content: input }],
    });

    const reply = res.choices[0].message?.content ?? "";
    console.log(`${chara.name}: ${reply}`);

    const moodMatch = reply.match(/\[MOOD:([+-]?\d+)\]/);
    if (moodMatch) {
      favorability += parseInt(moodMatch[1], 10);
      console.log(`(å¥½æ„Ÿåº¦: ${favorability})`);
    }
  }
}

main();
```

---

## 9. ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

* å¥½æ„Ÿåº¦ãƒãƒ¼ã®å¯è¦–åŒ–
* ã‚¤ãƒ™ãƒ³ãƒˆã‚·ãƒŠãƒªã‚ªã®è¿½åŠ ï¼ˆãƒ‡ãƒ¼ãƒˆãƒ»LINEé¢¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰
* æˆåŠŸ/å¤±æ•—ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
